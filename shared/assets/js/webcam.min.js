"use strict";!function(){navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.hasUserMedia=function(){return!!navigator.getMedia}}(),angular.module("webcam",[]).directive("webcam",function(){return{template:'<div class="webcam" ng-transclude></div>',restrict:"E",replace:!0,transclude:!0,scope:{onError:"&",onStream:"&",onStreaming:"&",placeholder:"=",config:"=channel"},link:function(e,t){var o=null,i=null,n=null;e.config=e.config||{};var r=function(e){e&&angular.element(e).remove()},a=function(){if(i){var e="function"==typeof i.getVideoTracks;if(i.getVideoTracks&&e){var t=i.getVideoTracks();t&&t[0]&&t[0].stop&&t[0].stop()}else i.stop&&i.stop()}o&&delete o.src},c=function(t){if(i=t,navigator.mozGetUserMedia)o.mozSrcObject=t;else{var n=window.URL||window.webkitURL;o.src=n.createObjectURL(t)}o.play(),e.config.video=o,e.onStream&&e.onStream({stream:t})},d=function(t){r(n),console&&console.log&&console.log("The following error occured: ",t),e.onError&&e.onError({err:t})},s=function(){o=document.createElement("video"),o.setAttribute("class","webcam-live"),o.setAttribute("autoplay",""),t.append(o),e.placeholder&&(n=document.createElement("img"),n.setAttribute("class","webcam-loader"),n.src=e.placeholder,t.append(n));var i=!1,a=t.width=e.config.videoWidth||320,s=t.height=0;if(!window.hasUserMedia())return void d({code:-1,msg:"Browser does not support getUserMedia."});var l={audio:!1,video:{width:{min:320,ideal:500,max:500},height:{min:320,ideal:500,max:500},facingMode:{exact:"environment"}}};navigator.getMedia(l,c,d),o.addEventListener("canplay",function(){if(!i){var t=a/o.videoWidth;s=o.videoHeight*t||e.config.videoHeight,o.setAttribute("width",a),o.setAttribute("height",s),i=!0,e.config.video=o,r(n),e.onStreaming&&e.onStreaming()}},!1)},l=function(){a(),o.remove()};e.$on("$destroy",a),e.$on("START_WEBCAM",s),e.$on("STOP_WEBCAM",l),s()}}});
//# sourceMappingURL=webcam.min.js.map
